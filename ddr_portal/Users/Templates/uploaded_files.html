{% load custom_tags %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Uploaded Files for {{ document.title }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <style>
    body { background-color: #f8f9fa; font-family: 'Segoe UI', sans-serif; }
    .container { margin-top: 40px; max-width: 1100px; }
    .card { border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); padding: 20px; }
    table, th, td { border: 1px solid #ddd; border-collapse: collapse; padding: 6px; }
    th { background-color: #f1f1f1; }
  </style>
  <script>
    $(document).ready(function () {
      $('#filesTable').DataTable();
    });
  </script>
</head>
<body>
  <div class="container">
    <div class="card">
      <h2 class="mb-4">üìÇ Uploaded Files for Document: <span class="fw-semibold">{{ document.title }}</span></h2>

      {% if files %}
      <table id="filesTable" class="display table table-striped">
        <thead>
          <tr>
            <th>File Name</th>
            <th>Size</th>
            <th>Uploaded By</th>
            <th>Uploaded At</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for file in files %}
          <tr>
            <td>{{ file.file_name }}</td>
            <td>{{ file.file_size|default:"Unknown" }} bytes</td>
            <td>{{ file.uploaded_by }}</td>
            <td>{{ file.upload_time }}</td>
            <td>
              <a href="{% url 'file_preview' file.id %}" class="btn btn-sm btn-secondary">üëÅ View</a>
              <a href="{% url 'history_download_file' file.id %}" class="btn btn-sm btn-success">‚¨á Download</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
        <p class="text-warning">‚ö† No files uploaded for this document.</p>
      {% endif %}

      <a href="{% url 'folder_list' %}" class="btn btn-link mt-3">‚Üê Back to Folders</a>
    </div>
  </div>
</body>
</html>
